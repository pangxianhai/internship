/*coolie built*/
define("0",["g","a","k","h","i","l","m","6","r"],function(e,t,n){var a,i,d,s,l,c,o,r=e("g");e("a");a=e("k");e("h");e("i");i=e("l");d=e("m");s=e("6");e("r");l={openExaminePanel:function(e){var t=r("#attendExaminePanel");this.attendExaminePanel=t.panel({contentWrap:r("#attend_list"),sourcePanelSwitch:!1});this.bindCloseExaminePanel(t);this.bindExamineAction(t,e.attr("attendRecordDesId"))},bindExamineAction:function(e,t){var n=e.find(".attend_status_list ._node");n.unbind("click");n.bind("click",function(){var e=r(this);i.yes_no("您确认要提交审核信息吗?",function(){l.attendExamine(t,e.attr("attendStatusCode"))})})},bindCloseExaminePanel:function(e){var t=e.find('button[item="cancelBtn"]');t.unbind("click");t.bind("click",function(){l.attendExaminePanel.closePanel()})},attendExamine:function(e,t){r.ajax({url:"/student/attend/examine.json",type:"POST",data:{attendRecordDestId:e,attendStatusCode:t},dataType:"json",success:function(e){if(e.ret){i.push_ok_message("审核成功");location.reload(!0)}else i.push_error_message(e.message)}})}};c={openSelectPanel:function(){this.selectPanel=r("#attendSelectNode").panel({contentWrap:r("#attend_list"),sourcePanelSwitch:!1,closeFunction:function(){r(".cover_panel").hide()}})},bindOpenSelectPanelAction:function(){var e=r("#selectBtn");e.off("click");e.on("click",function(){c.openSelectPanel();r('#attendSelectForm input[type="hidden"]').val("");r(".cover_panel").show()})},bindConfirmSelectPanelAction:function(){r('#attendSelectNode button[item="confirm"]').click(function(e){e.preventDefault();r('#attendSelectNode [name="desId"]').val("");o.loadAttendList(1);c.selectPanel.closePanel()});r('#attendSelectNode button[item="reset"]').click(function(e){e.preventDefault();r("#attendSelectNode").find("input").val("");r("#attendSelectNode").find("select").val("")})},bindAttendBeginDaySelectAction:function(){r("#attendBeginDayInput").click(function(){var e,t=r("#attendEndDayInput").val(),n=null;s.isNotEmpty(t)&&(n=new Date(t));e=r(this);r("#attendBeginSelectDatePicker").calendar({min_date:null,max_date:n,first_day:0,swipe_able:!0,select:function(t){e.val(t.format("yyyy-MM-dd"));r("#attendBeginSelectDatePicker").removeClass("active")},exceptHiddenNodes:["attendBeginDayInput","attendBeginSelectDatePicker"],hiddenFunction:function(){r("#attendBeginSelectDatePicker").removeClass("active")}});r("#attendBeginSelectDatePicker").addClass("active")})},bindAttendEndDaySelectAction:function(){r("#attendEndDayInput").click(function(){var e,t=r("#attendBeginDayInput").val(),n=null;s.isNotEmpty(t)&&(n=new Date(t));e=r(this);r("#attendEndSelectDatePicker").calendar({min_date:n,max_date:null,first_day:0,swipe_able:!0,select:function(t){e.val(t.format("yyyy-MM-dd"));r("#attendEndSelectDatePicker").removeClass("active")},exceptHiddenNodes:["attendEndDayInput","attendEndSelectDatePicker"],hiddenFunction:function(){r("#attendEndSelectDatePicker").removeClass("active")}});r("#attendEndSelectDatePicker").addClass("active")})},init:function(){this.bindOpenSelectPanelAction();this.bindConfirmSelectPanelAction();this.bindAttendBeginDaySelectAction();this.bindAttendEndDaySelectAction()}};o={bindAttendRecordScroll:function(){r("#attend_list .attend_node .attend_record_show").each(function(){var e,t,n=r(this);if("true"==n.attr("has_operate")){e=n.parent().find(".operate");t=e.width();new a({target_node:n,h_scroll:!0,max_scroll:t,start_event_callback:function(t){e.css("visibility","visible")},move_event_callback:function(e){},end_callback:function(a){var i=a.range,d=a.swipe_direction(i);if("_left"==d&&Math.abs(i.x1-i.x2)>=t/2)n.css({transform:"translate(-"+t+"px, 0px) scale(1) translateZ(0px)"});else{n.css({transform:"translate(0px, 0px) scale(1) translateZ(0px)"});e.css("visibility","hidden")}}})}})},pushAttendList:function(e){var t,n,a,i,d,s,l,c=[];for(t=0;t<e.length;++t){n=e[t];a=[];i=!1;for(d=0;d<n.flowRecords.length;++d){s=n.flowRecords[d];n.isApply&&s.operateUserId==o.user_id&&(i=!0);a.push(s.operateName)}l=!1;n.isApply&&n.userId==o.user_id&&(l=!0);c.push('<li class="attend_node">');if(l){c.push('<div class="operate operate_delete" can_delete="'+l+'" attendRecordDesId="'+n.desId+'">');c.push("删除");c.push("</div>")}else if(i){c.push('<div class="operate operate_examine" can_examine="'+i+'" attendRecordDesId="'+n.desId+'">');c.push("审核");c.push("</div>")}else{c.push('<div class="operate">');c.push("</div>")}c.push('<div class="attend_record_show" has_operate="'+(l||i)+'">');c.push('<ul class="attend_record">');c.push("<li>"+new Date(n.attendDay).format("yyyy-MM-dd")+"</li>");c.push("<li>"+n.timeInterval.desc+"</li>");c.push("<li>"+n.attendStatus.desc+"</li>");c.push("</ul>");c.push('<ul class="attend_message">');c.push("<li>"+n.student.name+"</li>");c.push("<li>"+n.student.studentNumber+"</li>");c.push("<li>"+a.join(",")+"</li>");c.push("</ul>");c.push("</div>");c.push("</li>")}r("#attend_list").append(c.join(""));this.bindAttendRecordScroll();this.bindDeleteAction()},deleteAttendRecord:function(e){i.yes_no("您确定要删除该签到信息吗?",function(){r.ajax({url:"/student/attend/delete.json",type:"POST",dataType:"json",data:{attendRecordDesId:e.attr("attendRecordDesId")},beforeSend:function(){i.dialog_load("删除中...")},success:function(t){i.close_dialog();if(t.ret){i.push_ok_message("删除成功!");e.parent().hide()}else i.push_error_message(t.message)}})})},bindDeleteAction:function(){var e=r("#attend_list .attend_node .operate");e.off("click");e.on("click",function(){var e=r(this);"true"==e.attr("can_delete")?o.deleteAttendRecord(e):"true"==e.attr("can_examine")&&l.openExaminePanel(e)})},loadAttendList:function(e){r.ajax({url:"/student/attend/list.json",type:"post",data:r.extend(s.getFormData(r("#attendSelectForm")),{currentPage:e}),dataType:"json",beforeSend:function(){i.dialog_load("正在加载签到记录...")},success:function(t){i.close_dialog();if(t.ret){e<=1&&r("#attend_list").html("");var n=t.data.page;d.loadSinglePage(n.currentPage,n.totalPage,r("#attend_list"),o.loadAttendList);o.pushAttendList(t.data.attendRecords)}else i.push_error_message(t.message)}})},init:function(){o.user_id=r("#user_id").val();this.loadAttendList(1);c.init()}};o.init()});
define("h",["g","6"],function(i,t,e){var n,o;i("g");n=i("6");o={initPanel:function(){"true"==$("#show_header_left").val()?$("header .header .left").css("visibility","visible"):$("header .header .left").css("visibility","hidden");var i=$("#headerRight").html();n.isNotEmpty(i)&&$("header .header .right").html(i)},initFooterMenu:function(){var i=$("#footerMenuId").val();$("footer .footer_menu").find("."+i).addClass("active")},bindLeftBtnAction:function(){$("header .header .left a").click(function(){var i=$("#returnUrl").val();n.isNotEmpty(i)?window.location.href=i:window.history.go(-1)})},init:function(){this.initPanel();this.bindLeftBtnAction();this.initFooterMenu();$("body").height($("body")[0].clientHeight)}};$(function(){o.init()})});
define("o",[],function(y,d,r){r.exports=".rDialog{position:fixed;_position:absolute}.rDialog-wrap{position:relative;background:#000;opacity:.7;background-clip:padding-box;border-radius:10px;-moz-border-radius:10px;-o-border-radius:10px;-webkit-border-radius:10px;box-shadow:1px 1px 1px #000;padding:.5em .5em}.rDialog-header-load{text-align:center;background:url(/static/images/0e6e0f46d7504242.gif);background-repeat:no-repeat;background-position:0 0;background-size:100%;width:30px;height:33px;margin:auto}.rDialog-header-alert,.rDialog-header-ok{text-align:center;background:url(/static/images/12dffd74007d31b6.png);background-repeat:no-repeat;background-size:100%;width:33px;height:36px;margin:auto}.rDialog-header-alert{background-position:0 -36px}.rDialog-header-ok{background-position:0 0}.rDialog-content{padding:1em 1em;font-size:1.1em;color:#FFF;overflow:hidden;text-align:center}.rDialog-footer{padding-left:15px;text-align:center}.rDialog-footer a{display:inline-block;margin:0 15px 15px 0;height:32px;line-height:32px;padding:0 30px;font-size:1rem;-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3px}.rDialog-footer a:hover,.rDialog-footer a:link,.rDialog-footer a:visited{color:#fff;text-decoration:none}.rDialog-ok,.rDialog-ok:hover{background:#c70066;color:#fff}.rDialog-cancel,.rDialog-cancel:hover{background:#E6E6E6;color:#A7A7A7}.rDialog-mask{position:fixed;_position:absolute;left:0;top:0;width:100%;height:100%;background:#000;filter:alpha(opacity=30);opacity:.3}"});
coolie.chunk(["0"]);