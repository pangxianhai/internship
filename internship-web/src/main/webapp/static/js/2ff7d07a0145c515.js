/*coolie built*/
define("0",["1","5","a","b","6","7","c"],function(e){var t,a,d,n,s,i=e("1");e("5");e("a");t=e("b");a=e("6");d=e("7");n=e("c");s={data:{action:"",isSysadmin:!1,isLeader:!1},pushTeacherInfo:function(e){var t,d,n=[];for(t=0;t<e.length;++t){d=e[t];n.push("<tr>");n.push("<td>"+d.name+"</td>");n.push("<td>"+d.userInfo.userName+"</td>");n.push("<td>"+d.userInfo.phone+"</td>");n.push("<td>"+d.userInfo.sex.desc+"</td>");n.push("<td>"+a.filterString(d.universityDepartmentInfo,"—")+"</td>");n.push("<td>"+d.rank+"</td>");n.push("<td>"+d.teacherType.desc+"</td>");n.push("<td>");"undefined"==typeof d.studentNumber?n.push(0):n.push(d.studentNumber);n.push("</td>");n.push("<td>");if("addStudent"==this.data.action)n.push('<a item="addStudent" teacherName="'+d.name+'"  teacherId="'+d.desId+'" href="javascript:void(0)">[分配]</a>');else if(this.data.isSysadmin){d.leader||n.push('<a item="setLeader" desId="'+d.desId+'" href="javascript:void(0)">[设为负责人]</a>');n.push('<a item="delete" desId="'+d.desId+'" href="javascript:void(0)">[删除]</a>')}else this.data.isLeader&&!d.leader&&n.push('<a item="delete" desId="'+d.desId+'" href="javascript:void(0)">[删除]</a>');n.push("</td>");n.push("</tr>")}return n.join("")},pushPageData:function(e){if(e.ret){i("#u_data").html(s.pushTeacherInfo(e.data.teachers));i(".page_list").html(t.html(e.data.page));t.turning_page(s.loadTeacherInfo);s.bindAddStudentAction();s.bindSetLeaderAction();s.bindDeleteTeacherAction()}},setLeader:function(e,a){i.ajax({url:"/teacher/setLeader.json",type:"POST",dataType:"json",data:{teacherDesId:e,teacherTypeCode:a},success:function(e){if(e.ret){d.openSample("提示","操作成功");s.loadTeacherInfo(t.current_page());d.close(2e3)}else d.openSample("提示",e.message)}})},checkHasLeader:function(e,t,a){i.ajax({url:"/teacher/checkTeacherHasLeader.json",type:"POST",dataType:"json",data:{teacherTypeCode:e,teacherDesId:t},success:function(n){n.ret?n.data?a(t,e):d.yesNo("提示","该单位已经有负责人了！你确定要更改负责人么？",function(){a(t,e)}):d.openSample("提示",n.message)}})},bindSetLeaderAction:function(){var e=i('a[item="setLeader"]');e.off("click");e.on("click",function(){var e=i(this);i(".teacher_type_select_panel").dialog({title:"请选择负责人类型",yesNo:!0,ok:function(){var t=i("#teacherType").val(),a=e.attr("desId");s.checkHasLeader(t,a,function(e,t){s.setLeader(e,t)})}})})},bindDeleteTeacherAction:function(){i('a[item="delete"]').unbind("click");i('a[item="delete"]').bind("click",function(){var e=i(this).attr("desId");d.yesNo("提示","您确定要删除该带队老师吗？",function(){i.ajax({url:"/teacher/delete.json",type:"POST",dataType:"json",data:{destId:e},success:function(e){if(e.ret){d.openSample("提示","删除成功!");s.loadTeacherInfo(t.current_page());d.close(2e3)}else d.openSample("提示",e.message)}})})})},loadTeacherInfo:function(e){i.ajax({url:"/teacher/list.json",type:"POST",data:i.extend(a.getFormData(i("#search_form")),{currentPage:e}),dataType:"json",beforeSend:function(){},success:s.pushPageData})},bindAddStudentAction:function(){var e=i('a[item="addStudent"]');e.unbind("click");e.bind("click",function(){var e=this;d.yesNo("提示","您确定将该学生分配给"+this.getAttribute("teacherName")+"吗？",function(){d.close(1);s.addStudent(e.getAttribute("teacherId"))})})},addStudent:function(e){var t=i("#studentId").val();i.ajax({url:"/student/updateTeacher.json",type:"POST",dataType:"json",data:{teacherDestId:e,studentDestId:t},success:function(e){if(e.ret){e.data==t.split(",").length?d.openSample("提示","分配成功"):d.openSample("提示","部分学生操作成功，您这个成功操作了"+e.data+"个学生");d.close(2e3);setTimeout(function(){window.location.href="/student/list.htm"},2e3)}else d.openSample("提示",e.message)}})},bindSearchAction:function(){var e="true"===i("#isUniversityLeader").val(),t="true"===i("#isCollegeLeader").val(),a="true"===i("#isDepartmentLeader").val(),d="true"===i("#isSpecialityLeader").val();n.initSelect({university:{selectNode:i('[name="universityDesId"]'),departmentId:i("#universityDesId").val(),lock:e||t||a||d},college:{selectNode:i('[name="collegeDesId"]'),departmentId:i("#collegeDesId").val(),lock:t||a||d},department:{selectNode:i('[name="departmentDesId"]'),departmentId:i("#departmentDesId").val(),lock:a||d},speciality:{selectNode:i('[name="specialityDesId"]'),departmentId:i("#specialityDesId").val(),lock:d},complete:function(){s.loadTeacherInfo(1)}});i("#search_action").click(function(){s.loadTeacherInfo(1)})},init:function(){this.data.action=i("#action").val();this.data.isSysadmin="true"==i("#isSysadmin").val();this.data.isLeader="true"==i("#isLeader").val();this.bindSearchAction()}};s.init()});
define("5",["1"],function(t,i,n){var e,o,s;t("1");e={init_choice:function(){var t=$("#menu_id").val();$(".menu_list").find("A").each(function(t){$(this);if(this.getAttribute("data")==t){$(this).addClass("current");$(this).removeClass("no_current")}else{$(this).addClass("no_current");$(this).removeClass("current")}},[t])}};o={timer:null,top:0,begin:function(t){o.timer=setInterval(function(){t.css("top",o.top+"px");o.top<-11?o.top=12:o.top-=1},180)},end:function(){null!=o.timer&&clearInterval(o.timer)}};s={tips_show:function(){o.begin($("#bulletin_head_tips"));$("#bulletin_head_tips").hover(function(){o.end()},function(){o.begin($("#bulletin_head_tips"))})}};$(function(){e.init_choice();s.tips_show()});i.get_title=function(){$(".menu").find(".title").val()}});
define("9",[],function(y,d,r){r.exports=".dialog-dialog_div{overflow:hidden;display:block;position:fixed;border:1px solid #3f55a0;border-top-right-radius:4px;border-top-left-radius:4px;z-index:1001}.dialog-dialog_div table{border-collapse:collapse;width:100%}.dialog-dialog_div .title{background-color:#3f55a0;overflow:hidden;display:block;height:30px;color:#FFF}.dialog-dialog_div .title span{line-height:35px;margin-left:8px;font-size:14px}.dialog-dialog_div .title .close{float:right;line-height:30px;font-size:25px;margin-right:10px;color:#FFF}.dialog-dialog_div .dialog_content{overflow:hidden;background-color:#FFF;padding-left:10px;word-break:break-all}.dialog-dialog_div .bottom{height:38px;overflow:hidden;background-color:#ccc}.dialog-dialog_div .bottom .no{float:left;margin-left:8px;border-radius:5px}.dialog-dialog_div .bottom .yes{float:right;margin-right:8px;border-radius:5px}"});
coolie.chunk(["0"]);